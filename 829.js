"use strict";(self.webpackChunkdemo=self.webpackChunkdemo||[]).push([[829],{2829:(M,g,a)=>{a.r(g),a.d(g,{WholesalePriceListModule:()=>T});var l=a(6895),u=a(6785),f=a(6082),h=a(4128),t=a(8256),m=a(6962),P=a(5861);let x=(()=>{const e=class{constructor(){this.products=[]}loadPdfLib(){return this.pdfLib||(this.pdfLib=Promise.all([a.e(822).then(a.bind(a,7822)),Promise.all([a.e(822),a.e(983)]).then(a.t.bind(a,2983,23))]).then(([r])=>r.default)),this.pdfLib}generatePdf(){var r=this;return(0,P.Z)(function*(){const o=new(yield r.loadPdfLib());o.setFontSize(20),o.text("Lista de Precios Mayorista",14,20),o.setFontSize(10),o.text(`Fecha: ${(new Date).toLocaleDateString()}`,14,30);const d=r.products.map(s=>[s.name,s.category_name,`$${s.price.toFixed(2)}`,`${s.tier1Quantity}+`,`$${s.tier1Price.toFixed(2)}`,`${s.tier2Quantity}+`,`$${s.tier2Price.toFixed(2)}`]);o.autoTable({head:[["Producto","Categor\xeda","Precio Regular","Cantidad Nivel 1","Precio Nivel 1","Cantidad Nivel 2","Precio Nivel 2"]],body:d,startY:40,styles:{fontSize:8,cellPadding:3},headStyles:{fillColor:[60,156,54],textColor:255,fontSize:8,fontStyle:"bold"},alternateRowStyles:{fillColor:[245,245,245]}});const p=o.getNumberOfPages();for(let s=1;s<=p;s++)o.setPage(s),o.setFontSize(8),o.text(`P\xe1gina ${s} de ${p}`,o.internal.pageSize.width/2,o.internal.pageSize.height-10,{align:"center"});o.save("lista-precios-mayorista.pdf")})()}};let i=e;return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-wholesale-price-list-pdf-generator"]],inputs:{products:"products"},decls:0,vars:0,template:function(n,o){},encapsulation:2}),i})();const Z=["pdfGenerator"];function C(i,e){1&i&&(t.TgZ(0,"div",6),t._UZ(1,"i",7),t._uU(2," Cargando lista de precios... "),t.qZA())}function v(i,e){if(1&i&&(t.TgZ(0,"div",8),t._uU(1),t.qZA()),2&i){const c=t.oxw();t.xp6(1),t.hij(" ",c.error," ")}}function b(i,e){if(1&i&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.ALo(7,"currency"),t.qZA(),t.TgZ(8,"td"),t._uU(9),t.qZA(),t.TgZ(10,"td"),t._uU(11),t.ALo(12,"currency"),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.qZA(),t.TgZ(15,"td"),t._uU(16),t.ALo(17,"currency"),t.qZA()()),2&i){const c=e.$implicit;t.xp6(2),t.Oqu(c.name),t.xp6(2),t.Oqu(c.category_name),t.xp6(2),t.Oqu(t.xi3(7,7,c.price,"USD")),t.xp6(3),t.hij("",c.tier1Quantity,"+"),t.xp6(2),t.Oqu(t.xi3(12,10,c.tier1Price,"USD")),t.xp6(3),t.hij("",c.tier2Quantity,"+"),t.xp6(2),t.Oqu(t.xi3(17,13,c.tier2Price,"USD"))}}function O(i,e){if(1&i){const c=t.EpF();t.TgZ(0,"div",9)(1,"div",10)(2,"button",11),t.NdJ("click",function(){t.CHM(c);const n=t.oxw();return t.KtG(n.downloadPdf())}),t._UZ(3,"i",12),t._uU(4," Descargar PDF "),t.qZA()(),t.TgZ(5,"div",13)(6,"table",14)(7,"thead")(8,"tr")(9,"th"),t._uU(10,"Producto"),t.qZA(),t.TgZ(11,"th"),t._uU(12,"Categor\xeda"),t.qZA(),t.TgZ(13,"th"),t._uU(14,"Precio Regular"),t.qZA(),t.TgZ(15,"th",15),t._uU(16,"Nivel 1"),t.qZA(),t.TgZ(17,"th",15),t._uU(18,"Nivel 2"),t.qZA()(),t.TgZ(19,"tr"),t._UZ(20,"th")(21,"th")(22,"th"),t.TgZ(23,"th"),t._uU(24,"Cantidad"),t.qZA(),t.TgZ(25,"th"),t._uU(26,"Precio"),t.qZA(),t.TgZ(27,"th"),t._uU(28,"Cantidad"),t.qZA(),t.TgZ(29,"th"),t._uU(30,"Precio"),t.qZA()()(),t.TgZ(31,"tbody"),t.YNc(32,b,18,16,"tr",16),t.qZA()()()()}if(2&i){const c=t.oxw();t.xp6(32),t.Q6J("ngForOf",c.products)}}let y=(()=>{const e=class{constructor(r,n){this.productService=r,this.discountSettingsService=n,this.products=[],this.loading=!0,this.error=null}ngOnInit(){this.loadData()}loadData(){this.loading=!0,this.error=null,(0,h.D)({products:this.productService.getProducts(),discounts:this.discountSettingsService.getSettings()}).subscribe({next:({products:r,discounts:n})=>{this.products=r.map(o=>({...o,tier1Price:o.price*(1-n.tier1_discount/100),tier2Price:o.price*(1-n.tier2_discount/100),tier1Quantity:n.tier1_quantity,tier2Quantity:n.tier2_quantity,tier1Discount:n.tier1_discount,tier2Discount:n.tier2_discount})),this.loading=!1},error:r=>{console.error("Error loading data:",r),this.error="Error al cargar los datos. Por favor, intente nuevamente.",this.loading=!1}})}downloadPdf(){this.pdfGenerator&&this.pdfGenerator.generatePdf()}};let i=e;return e.\u0275fac=function(n){return new(n||e)(t.Y36(f.M),t.Y36(m.r))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-wholesale-price-list"]],viewQuery:function(n,o){if(1&n&&t.Gf(Z,5),2&n){let d;t.iGM(d=t.CRH())&&(o.pdfGenerator=d.first)}},decls:8,vars:4,consts:[[1,"wholesale-container"],["class","loading",4,"ngIf"],["class","error-message",4,"ngIf"],["class","content",4,"ngIf"],[3,"products"],["pdfGenerator",""],[1,"loading"],[1,"fas","fa-spinner","fa-spin"],[1,"error-message"],[1,"content"],[1,"actions"],[1,"btn-download",3,"click"],[1,"fas","fa-file-pdf"],[1,"table-container"],[1,"price-table"],["colspan","2"],[4,"ngFor","ngForOf"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0)(1,"h2"),t._uU(2,"Lista de Precios Mayorista"),t.qZA(),t.YNc(3,C,3,0,"div",1),t.YNc(4,v,2,1,"div",2),t.YNc(5,O,33,1,"div",3),t._UZ(6,"app-wholesale-price-list-pdf-generator",4,5),t.qZA()),2&n&&(t.xp6(3),t.Q6J("ngIf",o.loading),t.xp6(1),t.Q6J("ngIf",o.error),t.xp6(1),t.Q6J("ngIf",!o.loading&&!o.error),t.xp6(1),t.Q6J("products",o.products))},dependencies:[l.sg,l.O5,x,l.H9],styles:[".wholesale-container[_ngcontent-%COMP%]{max-width:1200px;margin:2rem auto;padding:0 1rem}h2[_ngcontent-%COMP%]{color:#2c3e50;margin-bottom:2rem;text-align:center}.loading[_ngcontent-%COMP%]{text-align:center;padding:2rem;color:#3c9c36;font-size:1.2rem}.error-message[_ngcontent-%COMP%]{background-color:#fee2e2;color:#dc2626;padding:1rem;border-radius:8px;margin-bottom:1rem;text-align:center}.actions[_ngcontent-%COMP%]{margin-bottom:2rem;text-align:right}.btn-download[_ngcontent-%COMP%]{background-color:#3c9c36;color:#fff;border:none;padding:.75rem 1.5rem;border-radius:8px;cursor:pointer;font-size:1rem;display:inline-flex;align-items:center;gap:.5rem;transition:all .3s ease}.btn-download[_ngcontent-%COMP%]:hover{background-color:#2ecc71;transform:translateY(-2px)}.table-container[_ngcontent-%COMP%]{background:white;border-radius:8px;box-shadow:0 4px 6px #0000001a;overflow-x:auto}.price-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;min-width:800px}.price-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .price-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:1rem;text-align:left;border-bottom:1px solid #e2e8f0}.price-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f8fafc;color:#2c3e50;font-weight:600}.price-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f8fafc}.price-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{color:#4a5568}@media (max-width: 768px){.wholesale-container[_ngcontent-%COMP%]{margin:1rem;padding:0}.table-container[_ngcontent-%COMP%]{margin:0 -1rem;border-radius:0}.price-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .price-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.75rem;font-size:.9rem}}"]}),i})(),T=(()=>{const e=class{};let i=e;return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[l.ez,u.Bz.forChild([{path:"",component:y}])]}),i})()}}]);