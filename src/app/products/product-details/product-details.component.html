<div class="product-details-container" *ngIf="!isLoading && !errorMessage && product">
  <button class="btn-back" (click)="goBack()">
    <i class="fas fa-arrow-left"></i> Volver
  </button>
  
  <div class="product-content">
    <div class="product-image">
      <img [src]="product.image" [alt]="product.name">
      <span class="product-category">{{ product.category_name }}</span>
      <span class="stock-badge" [class.low-stock]="product.stock < 5" [class.out-of-stock]="product.stock === 0">
        {{ product.stock === 0 ? 'Sin stock' : product.stock < 5 ? 'Ãšltimas unidades' : product.stock + ' disponibles' }}
      </span>
    </div>
    
    <div class="product-info">
      <h1>{{ product.name }}</h1>
      <p class="description">{{ product.description }}</p>
      
      <div class="pricing-info">
        <div class="regular-price">
          <p class="price">{{ product.price | currency:'USD' }}</p>
          <span class="price-label">Precio unitario</span>
        </div>

        <div class="wholesale-pricing">
          <h3>Precios por mayor</h3>
          <div class="wholesale-tiers">
            <div class="tier">
              <span class="tier-quantity">{{ getQuantityTier1() }}+ unidades</span>
              <span class="tier-price">{{ getWholesalePrice(getQuantityTier1()) | currency:'USD' }} c/u</span>
              <span class="tier-discount">{{ getDiscountTier1() }}% descuento</span>
            </div>
            <div class="tier">
              <span class="tier-quantity">{{ getQuantityTier2() }}+ unidades</span>
              <span class="tier-price">{{ getWholesalePrice(getQuantityTier2()) | currency:'USD' }} c/u</span>
              <span class="tier-discount">{{ getDiscountTier2() }}% descuento</span>
            </div>
          </div>
        </div>
      </div>
      
      <div class="quantity-selector" *ngIf="product.stock > 0">
        <label>Cantidad:</label>
        <div class="quantity-controls">
          <button (click)="updateQuantity(-1)" [disabled]="quantity <= 1">-</button>
          <span>{{ quantity }}</span>
          <button (click)="updateQuantity(1)" [disabled]="quantity >= product.stock">+</button>
        </div>
        <div class="current-price" *ngIf="quantity >= getQuantityTier1()">
          <span class="price-label">Precio actual:</span>
          <span class="discounted-price">{{ getCurrentPrice() | currency:'USD' }} por unidad</span>
          <span class="discount-percentage">Descuento aplicado: {{ getCurrentDiscount() }}%</span>
          <span class="savings">Ahorro total: {{ getTotalSavings() | currency:'USD' }}</span>
        </div>
      </div>

      <p *ngIf="errorMessage" class="error-message">{{ errorMessage }}</p>
      
      <button class="btn-add-to-cart" (click)="addToCart()" [disabled]="product.stock === 0">
        <i class="fas fa-cart-plus"></i>
        {{ product.stock === 0 ? 'Sin stock' : 'Agregar al carrito' }}
      </button>
    </div>
  </div>
</div>

<div *ngIf="isLoading" class="loading">
  <p>Cargando detalles del producto...</p>
</div>

<div *ngIf="errorMessage" class="error-message">
  <p>{{ errorMessage }}</p>
</div>