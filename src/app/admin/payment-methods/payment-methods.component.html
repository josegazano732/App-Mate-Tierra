<div class="payment-methods-container">
  <h2>Gestión de Métodos de Pago</h2>

  <!-- Add New Payment Method Form -->
  <div class="add-method-section">
    <button 
      *ngIf="!showAddForm" 
      (click)="showAddForm = true" 
      class="btn-add">
      <i class="fas fa-plus"></i> Agregar Método de Pago
    </button>

    <div *ngIf="showAddForm" class="add-method-form">
      <h3>Agregar Nuevo Método de Pago</h3>
      <form (ngSubmit)="onSubmit()">
        <div class="form-group">
          <label for="name">Nombre:</label>
          <input 
            type="text" 
            id="name" 
            [(ngModel)]="newPaymentMethod.name" 
            name="name" 
            required>
        </div>
        <div class="form-group">
          <label for="code">Código:</label>
          <input 
            type="text" 
            id="code" 
            [(ngModel)]="newPaymentMethod.code" 
            name="code" 
            required>
          <small>El código debe ser único y sin espacios (ej: cash, card, transfer)</small>
        </div>
        <div class="form-group">
          <label>
            <input 
              type="checkbox" 
              [(ngModel)]="newPaymentMethod.active" 
              name="active">
            Activo
          </label>
        </div>
        <div class="form-actions">
          <button type="submit" class="btn-save">
            <i class="fas fa-save"></i> Guardar
          </button>
          <button type="button" (click)="showAddForm = false" class="btn-cancel">
            <i class="fas fa-times"></i> Cancelar
          </button>
        </div>
      </form>
    </div>
  </div>

  <div *ngIf="errorMessage" class="error-message">
    {{ errorMessage }}
  </div>

  <!-- Payment Methods List -->
  <div class="methods-list">
    <div *ngFor="let method of paymentMethods" class="method-card">
      <div *ngIf="editingPaymentMethod?.id !== method.id" class="method-display">
        <div class="method-info">
          <h3>{{ method.name }}</h3>
          <p class="method-code">Código: {{ method.code }}</p>
          <span class="method-status" [class.active]="method.active" [class.inactive]="!method.active">
            {{ method.active ? 'Activo' : 'Inactivo' }}
          </span>
        </div>
        <div class="method-actions">
          <button (click)="startEdit(method)" class="btn-edit" title="Editar">
            <i class="fas fa-edit"></i>
          </button>
          <button 
            (click)="toggleStatus(method)" 
            [class.btn-activate]="!method.active"
            [class.btn-deactivate]="method.active"
            [title]="method.active ? 'Desactivar' : 'Activar'">
            <i [class]="method.active ? 'fas fa-toggle-on' : 'fas fa-toggle-off'"></i>
          </button>
        </div>
      </div>

      <div *ngIf="editingPaymentMethod?.id === method.id" class="method-edit-form">
        <div class="form-group">
          <label for="edit-name">Nombre:</label>
          <input 
            type="text" 
            id="edit-name" 
            [ngModel]="editingPaymentMethod?.name" 
            (ngModelChange)="editingPaymentMethod!.name = $event"
            name="edit-name"
            required>
        </div>
        <div class="form-group">
          <label for="edit-code">Código:</label>
          <input 
            type="text" 
            id="edit-code" 
            [ngModel]="editingPaymentMethod?.code"
            (ngModelChange)="editingPaymentMethod!.code = $event"
            name="edit-code"
            required>
        </div>
        <div class="form-group">
          <label>
            <input 
              type="checkbox" 
              [ngModel]="editingPaymentMethod?.active"
              (ngModelChange)="editingPaymentMethod!.active = $event"
              name="edit-active">
            Activo
          </label>
        </div>
        <div class="form-actions">
          <button (click)="saveEdit()" class="btn-save">
            <i class="fas fa-save"></i> Guardar
          </button>
          <button (click)="cancelEdit()" class="btn-cancel">
            <i class="fas fa-times"></i> Cancelar
          </button>
        </div>
      </div>
    </div>
  </div>
</div>